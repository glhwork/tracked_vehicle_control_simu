clear;
clc;

hold on;
DrawMap();

dt = 0.2;
start_p = [2800, 3371]; 
goal_p = [5323, 8232];
robot_config = [290, 1];

[path_x, path_y] = PathGenerate(start_p, goal_p);
PlotPath(path_x, path_y);

pose = [1, 0, 0, 0;...
        0, 1, 0, 0;...
        0, 0, 1, 0;...
        0, 0, 0, 1];
    
while (1)
   
    [speed_left, speed_right] = PurePursuit(Pose, path_x, path_y);
    [dx, dy] = GetDeltaPosi(speed_left, speed_right, dt, robot_config);
    pose(1,4) = pose(1,4) + dx;
    pose(2,4) = pose(2,4) + dy;
    T = GetRotation(d_yaw);
    pose(1:3, 1:3) = pose(1:3, 1:3) * T;
    PlotPose(pose);
    
end